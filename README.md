# From Denoising to Scores: DAEs to Noise-Conditional Score Networks

This project implements and validates the theoretical link between **Denoising Autoencoders (DAE)** and **Noise-Conditional Score Networks (NCSN)**, showing how score estimation drives stable, high-quality generative modeling.

Vincent (2011) proved that a Gaussian DAE estimates the score of a smoothed log-density, $r_\theta(x) - x \approx \sigma^2 \nabla_x \log q_\sigma(x)$, establishing denoising score matching as equivalent to score matching on the noise-perturbed data. We build on this result to connect the DAE objective directly to score matching.

![A DAE learns a score](docs/poster/figures/scoresdae.png)

Noise-Conditional Score Networks (NCSN) extend this idea by training a score network conditioned on the noise level, enabling consistent score estimates across a noise schedule [Song & Ermon, 2019]. We verify experimentally that single-scale Langevin dynamics gets trapped in energy wells, which motivates **Annealed Langevin Dynamics (ALD)** to traverse the noise schedule without mode collapse. The NCSN + ALD results below highlight the improved sample quality and mixing versus single-scale.

![NCSN + ALD mixing](docs/poster/figures/exp1_mixing_comparison.png)

> *Vincent, P. 2011. A connection between score matching and denoising autoencoders. Neural Computation 23(7):1661â€“1674.*

> *Song, Y. and Ermon, S. 2019. Generative Modeling by Estimating Gradients of the Data Distribution. NeurIPS 32.*

## Project Structure

The repository is organized into distinct, clean directories for easy navigation:

| Directory | Purpose | Key Files |
| :--- | :--- | :--- |
| `src/` | **Source Code.** Contains all core Python modules. | `models_mnist.py`, `sampling.py` (Langevin implementations) |
| `scripts/` | **Execution Scripts.** Files used to run specific experiments. | `run_ablation.py`, `run_inpainting.py` |
| `results/` | **Generated Outputs.** Stores all plots and figures generated by the scripts. | `ablation/`, `mixing/`, `inpainting/` |
| `docs/` | **Final Deliverables.** Contains the final report and poster assets. | `report/`, `poster/` |
| `data/` | **Dataset Files.** Local storage for the MNIST dataset. | MNIST raw files |
| `assets/` | **Reference Papers.** Key literature used in the project. | `Song2019.pdf`, `Vincent.pdf` |


## Running Experiments

All execution scripts are located in the `scripts/` folder. Run them using the `-m` flag from the root directory to handle module imports correctly.

| Experiment | Goal | Command |
| :--- | :--- | :--- |
| **Ablation Study** | Verify $L=1$ failure and $L=50$ fragility. | `python -m scripts.run_ablation` |
| **Mixing Comparison** | Visualize how annealing fixes mode collapse. | `python -m scripts.run_bridge_exp` |
| **Inpainting** | Demonstrate conditional generative capacity. | `python -m scripts.run_inpainting` |

The generated images will be saved automatically into the corresponding `results/` subfolders (e.g., `results/ablation/`).
